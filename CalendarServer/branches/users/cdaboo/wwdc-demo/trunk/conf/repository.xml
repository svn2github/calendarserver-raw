<?xml version="1.0" encoding="utf-8"?>

<!--
Copyright (c) 2006 Apple Computer, Inc. All rights reserved.

This file contains Original Code and/or Modifications of Original Code
as defined in and that are subject to the Apple Public Source License
Version 2.0 (the 'License'). You may not use this file except in
compliance with the License. Please obtain a copy of the License at
http://www.opensource.apple.com/apsl/ and read it before using this
file.

The Original Code and all software distributed under the License are
distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
Please see the License for the specific language governing rights and
limitations under the License.
 -->

<!DOCTYPE repository SYSTEM "repository.dtd">

<repository>

  <docroot auto-principal-collection-set="no">
    <collection>
      <pytype>DAVFile</pytype>
      <properties>
        <acl>
          <ace>
            <principal><authenticated/></principal>
            <grant><privilege><read/></privilege></grant>
            <protected/>
          </ace>
          <ace>
            <principal><href>/principals/users/admin</href></principal>
            <grant><privilege><all/></privilege></grant>
            <protected/>
            <inheritable/>
          </ace>
        </acl>
        <!--  Must explicitly set which principal hierarchies will be listed in WebDAV properties.
              The order of these will determine how a user id will map to a principal in a particular hierarchy
              if an id appears in more than one. -->
             <prop><principal-collection-set xmlns='http://twistedmatrix.com/xml_namespace/dav/private/'><href xmlns='DAV:'>/principals/users/</href><href xmlns='DAV:'>/principals/groups/</href><href xmlns='DAV:'>/principals/resources/</href></principal-collection-set></prop>
      </properties>
      <members>
        <!--  We must define the calendar home location before the principals as
            auto-provisioning of accounts occurs when the principal collections are
            created and we need to have the calendar home path setup by then. -->
        <collection name="calendars" tag="calendars">
          <pytype>CalDAVFile</pytype>
          <properties>
            <acl>
              <ace>
                <principal><authenticated/></principal>
                <grant><privilege><read/></privilege></grant>
                <protected/>
              </ace>
            </acl>
          </properties>
          <members>
            <collection name="users">
              <pytype>CalendarHomeProvisioningFile</pytype>
              <properties>
                <acl>
                  <ace>
                    <principal><authenticated/></principal>
                    <grant><privilege><read/></privilege></grant>
                    <protected/>
                  </ace>
                </acl>
              </properties>
              <members/>
            </collection>
            <collection name="groups">
              <pytype>CalendarHomeProvisioningFile</pytype>
              <properties>
                <acl>
                  <ace>
                    <principal><authenticated/></principal>
                    <grant><privilege><read/></privilege></grant>
                    <protected/>
                  </ace>
                </acl>
              </properties>
              <members/>
            </collection>
            <collection name="resources">
              <pytype>CalendarHomeProvisioningFile</pytype>
              <properties>
                <acl>
                  <ace>
                    <principal><authenticated/></principal>
                    <grant><privilege><read/></privilege></grant>
                    <protected/>
                  </ace>
                </acl>
              </properties>
              <members/>
            </collection>
            <collection name="public">
              <properties>
                <acl>
                  <ace>
                    <principal><unauthenticated/></principal>
                    <grant><privilege><read/></privilege></grant>
                    <protected/>
                    <inheritable/>
                  </ace>
                  <ace>
                    <principal><authenticated/></principal>
                    <grant><privilege><read/></privilege></grant>
                    <protected/>
                    <inheritable/>
                  </ace>
                </acl>
              </properties>
              <members/>
            </collection>
          </members>
        </collection>
        <collection name="principals" tag="principals">
          <pytype>DirectoryPrincipalProvisioningResource</pytype>
          <params>
            <param>
              <key>DirectoryNode</key>
              <value>/Search</value>
            </param>
          </params>
          <properties>
            <acl>
              <ace>
                <principal><authenticated/></principal>
                <grant><privilege><read/></privilege></grant>
                <protected/>
              </ace>
            </acl>
          </properties>
          <members>
            <collection name="users">
              <pytype>DirectoryUserPrincipalProvisioningResource</pytype>
              <properties>
                <acl>
                  <ace>
                    <principal><authenticated/></principal>
                    <grant><privilege><read/></privilege></grant>
                    <protected/>
                  </ace>
                </acl>
              </properties>
              <members/>
            </collection>
            <collection name="groups">
              <pytype>DirectoryGroupPrincipalProvisioningResource</pytype>
              <properties>
                <acl>
                  <ace>
                    <principal><authenticated/></principal>
                    <grant><privilege><read/></privilege></grant>
                    <protected/>
                  </ace>
                </acl>
              </properties>
              <members/>
            </collection>
            <collection name="resources">
              <pytype>DirectoryResourcePrincipalProvisioningResource</pytype>
              <properties>
                <acl>
                  <ace>
                    <principal><authenticated/></principal>
                    <grant><privilege><read/></privilege></grant>
                    <protected/>
                  </ace>
                </acl>
              </properties>
              <members/>
            </collection>
          </members>
        </collection>
      </members>
    </collection>
  </docroot>

  <accounts/>

</repository>
